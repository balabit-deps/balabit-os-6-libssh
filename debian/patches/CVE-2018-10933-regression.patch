Backport of:

From 4ea46eecce9f4e676150fe27fec34e1570b70ace Mon Sep 17 00:00:00 2001
From: Meng Tan <mtan@wallix.com>
Date: Wed, 17 Oct 2018 14:50:08 +0200
Subject: server: Set correct state after sending INFO_REQUEST (Kbd
 Interactive)

Signed-off-by: Meng Tan <mtan@wallix.com>
Reviewed-by: Andreas Schneider <asn@cryptomilk.org>
---
 src/server.c | 1 +
 1 file changed, 1 insertion(+)

Index: libssh-0.6.3/src/server.c
===================================================================
--- libssh-0.6.3.orig/src/server.c	2018-11-27 10:01:40.703994571 -0500
+++ libssh-0.6.3/src/server.c	2018-11-27 10:04:11.408460679 -0500
@@ -985,7 +985,6 @@ int ssh_message_auth_interactive_request
       msg->session->kbdint = NULL;
       return SSH_PACKET_USED;
   }
-
   msg->session->kbdint->nprompts = num_prompts;
   if(num_prompts > 0) {
     msg->session->kbdint->prompts = malloc(num_prompts * sizeof(char *));
@@ -1018,6 +1017,7 @@ int ssh_message_auth_interactive_request
     msg->session->kbdint->prompts = NULL;
     msg->session->kbdint->echo = NULL;
   }
+  msg->session->auth_state = SSH_AUTH_STATE_INFO;
 
   return r;
 }
